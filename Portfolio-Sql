IF OBJECT_ID('[dbo].[SUPERSTOREDATA]') IS NOT NULL DROP TABLE [dbo].[SUPERSTOREDATA]
CREATE TABLE SUPERSTOREDATA (RowID INT,	OrderID NVARCHAR (15),	OrderDate date,	ShipDate date,	ShipMode NVARCHAR (20),	CustomerID NVARCHAR (8),	CustomerName NVARCHAR (50),	
							Segment NVARCHAR (30),	Country NVARCHAR (30),	City NVARCHAR (30),	StateN NVARCHAR (30),	PostalCode INT,	Region NVARCHAR (30),	ProductID NVARCHAR (15),
							Category NVARCHAR (30),	SubCategory NVARCHAR (30),	ProductName NVARCHAR (150),	Sales MONEY,	Quantity INT,	Discount DECIMAL (6,4),	Profit MONEY)

-- to let sql know the format of the date in the *.csv file
SET DATEFORMAT DMY

BULK INSERT [dbo].[SUPERSTOREDATA]
FROM 'C:\Users\User\Desktop\Dataset\WorkingSuperstoredata.csv'
WITH (FORMAT = 'CSV') 

--SELECT * FROM [dbo].[SUPERSTOREDATA] ORDER BY RowID

SELECT OrderID, [CustomerID], [ProductID], [OrderDate], [ShipDate], [ShipMode]
INTO ORDERTABLE
FROM [dbo].[SUPERSTOREDATA]

SELECT [CustomerID], [CustomerName], [Segment], [City], [StateN], [PostalCode], [Region], [Country]
INTO CUSTOMERTABLE
FROM [dbo].[SUPERSTOREDATA]

SELECT [ProductID], [ProductName], [Category], [SubCategory], [Quantity], [Sales], [Discount], [Profit]
INTO PRODUCTTABLE 
FROM [dbo].[SUPERSTOREDATA]

--SELECT Distinct customerID as TotalOrders FROM ORDERTABLE
--SELECT * FROM OrderTable 

CREATE VIEW OrderDetails as
Select c.CustomerName, C.PostalCode, C.City, O.OrderDate, O.ShipDate
,P.ProductName,P.Quantity, P.Sales, P.Profit
from OrderTable as O INNER JOIN CustomerTable as C
ON o.CustomerID = c.CustomerID
INNER JOIN ProductTable as P
ON o.ProductID = p.ProductID
